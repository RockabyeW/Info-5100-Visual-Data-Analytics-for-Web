<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      .gridlines line {
        stroke: #bbb;
      }

      .gridlines .domain {
        stroke: none;
      }
    </style>
</head>
<body>
  <h2>Project 1</h2>
  <h2>George Gu, Jerray Wu, Xiaohan Wang</h2><br>
  <svg height=800 width=1800 id='bar'>
  </svg><br>
  <svg height=600 width=1800 id='donut'>
  </svg>
  <script>
    const svg = d3.select("svg#bar");
    const height = svg.attr("height");
    const width = svg.attr("width");
    const margin = {top: 50, right: 10, bottom: 50, left: 50};
    const chartWidth = width - margin.left - margin.right;
    const chartHeight = height - margin.top - margin.bottom;
    let barChart0 = svg.append('g')
                        .attr('transform',`translate(${margin.left},${margin.top})`);
    let barChart1 = svg.append('g')
                        .attr('transform',`translate(${margin.left},${margin.top})`);
    let barChart2 = svg.append('g')
                        .attr('transform',`translate(${margin.left},${margin.top})`);

    let barTitle = svg.append("g")
                       .attr("transform", `translate(${margin.left+830},${margin.top-50})`)

    const svg2 = d3.select("svg#donut");
    const height2 = svg2.attr("height");
    const width2 = svg2.attr("width");
    const radius = 110;
    const marginpie = {top: 325, right: 10, bottom: 50, left: 150, middleW: width2/2 };

    
    let pieChart0 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left},${marginpie.top})`)
    let pieChart1 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left+300},${marginpie.top})`)
    let pieChart2 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left+600},${marginpie.top})`)
    let pieChart3 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left+900},${marginpie.top})`)
    let pieChart4 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left+1200},${marginpie.top})`)
    let pieChart5 = svg2.append("g")
                        .attr("transform", `translate(${marginpie.left+1500},${marginpie.top})`)
    

    let pieTitle = svg2.append("g")
                        .attr("transform", `translate(${marginpie.middleW},${marginpie.top-50})`)
    let pieSales = svg2.append("g")
                        .attr("transform", `translate(${marginpie.middleW},${marginpie.top+300})`)
  
    d3.csv('./Video_Games_Sales_2016.csv', d3.autoType).then( (data) => {
    console.log(data);

    // Sort data by publisher
    var gamesByPublisher = new Map();
    d3.group(data, d => d.Publisher).forEach((key, value) => {
      gamesByPublisher.set(value, key.length)
    });
    // console.log(gamesByPublisher);

    // Make the sorted data to a new map
    var games = new Map();
    d3.group(data, d => d.Publisher).forEach((key, value) => {
      games.set(value, key)
    });
    // console.log(games)

    // Get the top 6 publishers
    var gamesByPublisherSorted = new Map([...gamesByPublisher.entries()].sort((a, b) => b[1] - a[1]));
    var top6Publisher = [];
    for (let i=0; i<6; i++) {
      top6Publisher[i] = Array.from(gamesByPublisherSorted.keys())[i]
    }
    console.log(top6Publisher);

    // Get the best game of top 6 publishers
    var bestGames = [];
    for (let i=0; i<top6Publisher.length; i++) {
      var bestGame = games.get(top6Publisher[i]).reduce((prev, current) => (prev.Global_Sales > current.Global_Sales) ? prev : current)
      bestGames.push(bestGame)
    }
    console.log(bestGames);

    // Chart Title:
    barTitle.append("text")
       .text("Top 6 Game Publishers‘ Performance: Analyzing Game Popularity on 50th, 75th, and 100th Percentile Based on Global Sales")
       .attr("y", 20)
       .attr("text-anchor", "middle")
       .attr("font-size", "25px")
       .attr("fill", "black")
       .attr("font-weight", "bold");

//     barTitle.append("text")
//        .text("Top 6 Game Publishers‘ Performance: Analyzing Game Popularity on 50th, 75th, and 100th Percentile Based on Global Sales")
//        .attr("y", 30)
//        .attr("text-anchor", "middle")
//        .attr("font-size", "15px")
//        .attr("fill", "black")

    // X axis (publisher):
    const publisherScale = d3.scaleBand().domain(top6Publisher).range([0, chartWidth]).padding(0.5);
    let bottomAxis = d3.axisBottom(publisherScale);
    let bottomGridlines = d3.axisBottom(publisherScale)
                            .tickSize(-chartHeight-10)
                            .tickFormat("");
    svg.append("g")
       .attr("class", "x axis")
       .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
       .call(bottomAxis);
    svg.append("g")
       .attr("class", "gridlines")
       .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
       .call(bottomGridlines);

    // Y axis (sales):
    var maxSalesBestGames = d3.max(bestGames, function(d) {
        return d.Global_Sales;
    })
    const salesScale = d3.scaleSqrt().domain([0, maxSalesBestGames]).range([chartHeight, 0]);
    let leftAxis = d3.axisLeft(salesScale);
    let leftGridlines = d3.axisLeft(salesScale)
                          .tickSize(-chartWidth-10)
                          .tickFormat("");
    svg.append("g")
       .attr("class", "y axis")
       .attr("transform",`translate(${margin.left-10},${margin.top})`)
       .call(leftAxis);
    svg.append("g")
       .attr("class", "gridlines")
       .attr("transform",`translate(${margin.left-10},${margin.top})`)
       .call(leftGridlines);

    let colorScale = d3.scaleLinear()
                       .domain([1, maxSalesBestGames])
                       .range(['navy','turquoise'])
                       .interpolate(d3.interpolateHcl);

    // Best Games Bar Chart:
    barChart0.raise();
    barChart0.selectAll("rect.bar")
             .data(bestGames)
             .join("rect")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher))
             .attr("y", d => salesScale(d.Global_Sales))
             .attr("width", publisherScale.bandwidth())
             .attr("height", d => chartHeight - salesScale(d.Global_Sales))
             .attr("fill", "lightskyblue");
    
    // append different image tiled to separate bar
//     barChart0.selectAll("image")
//           .data(bestGames)
//           .join("image")
//           .attr("xlink:href", d => {
//             if (d.Publisher == "Electronic Arts") {
//               return "https://s22.q4cdn.com/894350492/files/design/banner/EA-Emblem.png"
//             } else if (d.Publisher == "Activision") {
//               return "https://img.freepik.com/free-vector/retro-game-background_23-2148509509.jpg?size=626&ext=jpg"
//             } else if (d.Publisher == "Namco Bandai Games") {
//               return "https://img.freepik.com/premium-photo/football-field_52465-16.jpg?w=1800"
//             } else if (d.Publisher == "Ubisoft") {
//               return "https://img.freepik.com/free-vector/retro-game-background_23-2148509509.jpg?size=626&ext=jpg"
//             } else if (d.Publisher == "Konami Digital Entertainment") {
//               return "https://img.freepik.com/free-vector/retro-game-background_23-2148509509.jpg?size=626&ext=jpg"
//             } else if (d.Publisher == "THQ") {
//               return "https://img.freepik.com/free-vector/retro-game-background_23-2148509509.jpg?size=626&ext=jpg"
//             }
//           })
//           .attr("x", d => publisherScale(d.Publisher))
//           .attr("y", d => salesScale(d.Global_Sales))
//           .attr("width", publisherScale.bandwidth())
//           .attr("height",100)
//           // .attr("preserveAspectRatio", "xMidYMid slice")
//           .attr("opacity", 0.9);
    
    // Best Games Bar Chart Label:
    barChart0.selectAll("text.bar")
             .data(bestGames)
             .join("text")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) - 5)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Name);

    // Best Game Sales Label:
    barChart0.selectAll("text.sales")
             .data(bestGames)
             .join("text")
             .attr("class", "sales")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) + 15)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Global_Sales);
            
    // Get the 75% percentage game of top 6 publishers
    var ThreeFourthPercentileGames = [];
    for (let i=0; i<top6Publisher.length; i++) {
      var ThreeFourthPercentileGame = games.get(top6Publisher[i]).sort((a, b) => b.Global_Sales - a.Global_Sales)[Math.floor(games.get(top6Publisher[i]).length * .25)]
      ThreeFourthPercentileGames.push(ThreeFourthPercentileGame)
    }
    console.log(ThreeFourthPercentileGames);

    // 75% Percentage Games Bar Chart:
    barChart1.raise();
    barChart1.selectAll("rect.bar")
             .data(ThreeFourthPercentileGames)
             .join("rect")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher))
             .attr("y", d => salesScale(d.Global_Sales))
             .attr("width", publisherScale.bandwidth())
             .attr("height", d => chartHeight - salesScale(d.Global_Sales))
             .attr("fill", "lightgreen");
    
    // 75% Percentage Games Bar Chart Label:
    barChart1.selectAll("text.bar")
             .data(ThreeFourthPercentileGames)
             .join("text")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) - 5)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Name);
    
    // 75% Percentage Game Sales Label:
    barChart1.selectAll("text.sales")
             .data(ThreeFourthPercentileGames)
             .join("text")
             .attr("class", "sales")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) + 15)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Global_Sales);

    // Get the median game of top 6 publishers
    var medianGames = [];
    for (let i=0; i<top6Publisher.length; i++) {
      var medianGame = games.get(top6Publisher[i]).sort((a, b) => a.Global_Sales - b.Global_Sales)[Math.floor(games.get(top6Publisher[i]).length/2)]
      medianGames.push(medianGame)
    }
    console.log(medianGames);

    // Median Games Bar Chart:
    barChart2.raise();
    barChart2.selectAll("rect.bar")
             .data(medianGames)
             .join("rect")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher))
             .attr("y", d => salesScale(d.Global_Sales))
             .attr("width", publisherScale.bandwidth())
             .attr("height", d => chartHeight - salesScale(d.Global_Sales))
             .attr("fill", "orange");

    // Median Games Bar Chart Label:
    barChart2.selectAll("text.bar")
             .data(medianGames)
             .join("text")
             .attr("class", "bar")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) - 5)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Name);
    
    // Median Game Sales Label:
    barChart2.selectAll("text.sales")
             .data(medianGames)
             .join("text")
             .attr("class", "sales")
             .attr("x", d => publisherScale(d.Publisher) + publisherScale.bandwidth()/2)
             .attr("y", d => salesScale(d.Global_Sales) + 15)
             .attr("text-anchor", "middle")
             .attr("font-size", "15px")
             .attr("fill", "black")
             .text(d => d.Global_Sales);

    // Sales by Region:
    var regionSales = [];
    for (let i=0; i<bestGames.length; i++) {
      var regionSale = [{name: bestGames[i].Name, NA_Sales: bestGames[i].NA_Sales, EU_Sales: bestGames[i].EU_Sales, 
                         JP_Sales: bestGames[i].JP_Sales, Other_Sales: bestGames[i].Other_Sales}];
      regionSales.push(regionSale);
    }
    console.log(regionSales);

    let pieColor = d3.scaleOrdinal(['#4daf4a','#377eb8','#ff7f00','#984ea3','#e41a1c']);

    
    var data2 = [];
    for (let i=0; i<regionSales.length; i++) {
      data2.push({game: regionSales[i][0].name, sales: [regionSales[i][0].NA_Sales, regionSales[i][0].EU_Sales, regionSales[i][0].JP_Sales, regionSales[i][0].Other_Sales]});
    }

    console.log(data2);

    // Donut Chart:
    let pie = d3.pie();
    var arc = d3.arc()
		.innerRadius(77)
		.outerRadius(radius);
    
    function countPercentage(countArray){
      var j = eval(countArray.join('+'));
      var resultArray = [];
      for (var i = 0 ; i < countArray.length ; i++){
          var k = Math.floor((countArray[i]/j)*100 * 100) / 100;
          resultArray.push(k);
      }
      return resultArray;
    }
    //Donut0
    let toPercent0 = countPercentage(data2[0].sales)

    var arcs = pieChart0.selectAll("arc")
                        .data(pie(toPercent0))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
              return pieColor(i);
            })
            .attr("d", arc);
    
    // Donut chart label:
    arcs.append("text")
    .attr("transform", function(d) {
            var _d = arc.centroid(d);
        _d[0] *= 1.4; 
        _d[1] *= 1.4; 
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
          return d.data +'%';
        });

//     // Donut chart name:
//     pieChart0.append("text")
//               .attr("x", 0)
//               .attr("y", 0)
//               .attr("text-anchor", "middle")
//               .attr("font-size", "20px")
//               .attr("fill", "black")
//               .text(data2[0].game);

//Logo

    pieChart0.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/fifa16.png")
                .attr("width", 154)
                .attr("height",154)


    pieChart0.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)
    
    // Donut chart title publisher:
    pieChart0.append("text")
              .attr("x", 0)
              .attr("y", -170)
              .attr("text-anchor", "middle")
              .attr("font-size", "20px")
              .attr("fill", "black")
              .text(top6Publisher[0]);


    //Donut1
    let toPercent1 = countPercentage(data2[1].sales)

    var arcs = pieChart1.selectAll("arc")
                        .data(pie(toPercent1))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
              return pieColor(i);
            })
            .attr("d", arc);
    
    // Donut chart label:
    arcs.append("text")
    .attr("transform", function(d) {
            var _d = arc.centroid(d);
        _d[0] *= 1.4; 
        _d[1] *= 1.4; 
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
          return d.data +'%';
        });

//     // Donut chart name:
//     pieChart1.append("text")
//               .attr("x", 0)
//               .attr("y", 0)
//               .attr("text-anchor", "middle")
//               .attr("font-size", "10px")
//               .attr("fill", "black")
//               .text(data2[1].game);

//Logo

    pieChart1.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/cod.png")
                .attr("width", 154)
                .attr("height",154)

    pieChart1.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)
                
                
    // Donut chart title publisher:
    pieChart1.append("text")
              .attr("x", 0)
              .attr("y", -170)
              .attr("text-anchor", "middle")
              .attr("font-size", "20px")
              .attr("fill", "black")
              .text(top6Publisher[1]);

    //Donut2
    let toPercent2 = countPercentage(data2[2].sales)

    var arcs = pieChart2.selectAll("arc")
                        .data(pie(toPercent2))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
            return pieColor(i);
            })
            .attr("d", arc);

    // Donut chart label:
    let i=0;
    arcs.append("text")
    .attr("transform", function(d) {
        var _d = arc.centroid(d);
        if(i==3){        
                _d[0] = _d[0]*3; 
                _d[1] = _d[1]*1.2; 
        }
        else{
                _d[0] = _d[0]*1.4; 
                _d[1] = _d[1]*1.4; 
        }
        i++;
        console.log(_d[0])
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
        return d.data +'%';
        });

//     // Donut chart name:
//     pieChart2.append("text")
//             .attr("x", 0)
//             .attr("y", 0)
//             .attr("text-anchor", "middle")
//             .attr("font-size", "18px")
//             .attr("fill", "black")
//             .text(data2[2].game);

//Logo

    pieChart2.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/namoco1.png")
                .attr("width", 154)
                .attr("height",154)

    pieChart2.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)


    // Donut chart title publisher:
    pieChart2.append("text")
            .attr("x", 0)
            .attr("y", -170)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text(top6Publisher[2]);


    //Donut3
    let toPercent3 = countPercentage(data2[3].sales)

    var arcs = pieChart3.selectAll("arc")
                        .data(pie(toPercent3))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
            return pieColor(i);
            })
            .attr("d", arc);

    // Donut chart label:
    arcs.append("text")
    .attr("transform", function(d) {
            var _d = arc.centroid(d);
        _d[0] *= 1.4; 
        _d[1] *= 1.4; 
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
        return d.data +'%';
        });

//     // Donut chart name:
//     pieChart3.append("text")
//             .attr("x", 0)
//             .attr("y", 0)
//             .attr("text-anchor", "middle")
//             .attr("font-size", "20px")
//             .attr("fill", "black")
//             .text(data2[3].game);

//Logo

    pieChart3.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/jd3.png")
                .attr("width", 154)
                .attr("height",154)

    pieChart3.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)


    // Donut chart title publisher:
    pieChart3.append("text")
            .attr("x", 0)
            .attr("y", -170)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text(top6Publisher[3]);

    //Donut4
    let toPercent4 = countPercentage(data2[4].sales)

    var arcs = pieChart4.selectAll("arc")
                        .data(pie(toPercent4))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
            return pieColor(i);
            })
            .attr("d", arc);

    // Donut chart label:
    arcs.append("text")
    .attr("transform", function(d) {
            var _d = arc.centroid(d);
        _d[0] *= 1.4; 
        _d[1] *= 1.4; 
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
        return d.data +'%';
        });

//     // Donut chart name:
//         function change(_str){    
//         var str = _str, result = "";
//         var n=6;
//         for(var i=0,len=str.length;i<len;i++){
//         result += str[i];
//         if(i==n)
//         result += "\r\n";
//         }
//         return result;
//         }
//     pieChart4.append("text")
//             .attr("x", 0)
//             .attr("y", 0)
//             .attr("text-anchor", "middle")
//             .attr("font-size", "9px")
//             .attr("fill", "black")
//             .text(change(data2[4].game));

//Logo

    pieChart4.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/metal.png")
                .attr("width", 154)
                .attr("height",154)
        
    pieChart4.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)

    // Donut chart title publisher:
    pieChart4.append("text")
            .attr("x", 0)
            .attr("y", -170)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text(top6Publisher[4]);


    //Donut5
    let toPercent5 = countPercentage(data2[5].sales)

    var arcs = pieChart5.selectAll("arc")
                        .data(pie(toPercent5))
                        .enter()
                        .append("g")
                        .attr("class", "arc")

        arcs.append("path")
            .attr("fill", function(d, i) {
            return pieColor(i);
            })
            .attr("d", arc);

    // Donut chart label:
    let count = 0;
    arcs.append("text")
    .attr("transform", function(d) {
        var _d = arc.centroid(d);
        if(count==3){        
                _d[0] = _d[0]*2.0; 
                _d[1] = _d[1]*1.3; 
        }
        else{
                _d[0] = _d[0]*1.4; 
                _d[1] = _d[1]*1.4; 
        }

        count++;
        console.log(_d[0])
        return "translate(" + _d + ")";
        })
        .attr("text-anchor", "middle")
        .attr("font-size", "12px")
        .attr("fill", "black")
        .text(function(d) {
        return d.data +'%';
        });
        


//     // Donut chart name:
//     pieChart5.append("text")
//             .attr("x", 0)
//             .attr("y", 0)
//             .attr("text-anchor", "middle")
//             .attr("font-size", "15px")
//             .attr("fill", "black")
//             .text(data2[5].game);

    //Logo
    pieChart5.append("image")
                .attr("x", -77)
                .attr("y", -77)
                .attr("xlink:href", "games/smack.png")
                .attr("width", 154)
                .attr("height",154)

    pieChart5.append("circle")
                .attr("x", -77)
                .attr("y", -77)
                .attr("r", 78)
                .attr("fill", "none")
                .style("stroke", "white")
                .style("stroke-width", 3)



    // Donut chart title publisher:
    pieChart5.append("text")
            .attr("x", 0)
            .attr("y", -170)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text(top6Publisher[5]);
    
    pieTitle.append("text")
            .attr("y", -220)
            .attr("text-anchor", "middle")
            .attr("font-size", "25px")
            .attr("fill", "black")
            .attr("font-weight", "bold")
            .text("Top 6 Game Publishers' Best Games: Regional Sales Breakdown");

    pieTitle.append("text")
       .text("Each pie chart shows the regional distribution (North America, Europe, Japan, and other regions) of sales of the best games produced by the above publishers")
       .attr("y",-180)
       .attr("text-anchor", "middle")
       .attr("font-size", "15px")
       .attr("fill", "grey")

        
    pieSales.append("rect")
            .attr("x", -250)
            .attr("y", -150)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", '#4daf4a')

    pieSales.append("text")
            .attr("x", -145)
            .attr("y", -133)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text("North America");
        
    pieSales.append("rect")
            .attr("x", 60)
            .attr("y", -150)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", '#377eb8')

    pieSales.append("text")
            .attr("x", 160)
            .attr("y", -133)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text("Europe");

    pieSales.append("rect")
            .attr("x", -250)
            .attr("y", -100)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", '#ff7f00')

    pieSales.append("text")
            .attr("x", -145)
            .attr("y", -82)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text("Japan");
            
    pieSales.append("rect")
            .attr("x", 60)
            .attr("y", -100)
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", '#984ea3')

    pieSales.append("text")
            .attr("x", 165)
            .attr("y", -82)
            .attr("text-anchor", "middle")
            .attr("font-size", "20px")
            .attr("fill", "black")
            .text("Other Regions");

    });
  </script>
</body>
</html>